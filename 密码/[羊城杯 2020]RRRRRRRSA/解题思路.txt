wiener attack原理阐述：
在 RSA 中我们根据ed =1 mod ψ(n)有如下推导：
ed =1 mod ψ(n) ⇒ ed =1 mod phi ⇒ ed -1 =kphi ⇒ e/phi - k/d =1/(dphi)
可以发现当 p,q 很大时，phi 和 n 是接近的，即phi(N)≈N，且phi(N)非常大。
1/(d*phi) 很小，说明 e/phi 和 k/d 很接近，于是就有 e/n 和 k/d 很接近。
当 e 很大时，由于 e 和 N 都是已知的，通过对 e/n 进行连分数展开，然后对每一项求其渐进分数，通过遍历渐进分数 k/d 很有可能就被 e/n 的众多项渐进分数中的一项所覆盖，只要检验一下 ed mod phi(N) 看它是不是1就知道对不对了。
假设覆盖它的是 k1/d1，那么 k1=k ;
d1=d，得到两个数之后就可以用常规的 RSA 解题流程解题了。
wiener attack 就是这样一个依靠连分数进行的攻击方式，适用于非常接近某一值（比如1）时，求一个比例关系，通过该比例关系再来反推关键信息就简单很多，这种攻击对于解密指数 d 很小，即 e 和 N 很相近，位数将近一样时有很好的效果。
特别的：
wiener attack并不是针对于解密指数的攻击方式，实际上，在低解密指数的情况下，任何比例非常接近另外一个已知比例的情况下都可以尝试用这个方法得到RSA中重要解密信息，不一定是 d，也有可能是 p 或者 q 。
补充1：
这里可能会有疑问,如果 gcd(k,d)!=1 那么对于最简的 k1/d1 来说是否应该存在t使得 tk1=k td1=d 呢? 
但其实这里 gcd(k,d) 一定为 1 即 k，d 一定互质.证明也很简单.
前面我们可以得到:
ed-kphi=1 对于这么一个式子,在扩展欧几里得里有如果gcd(d,k)!=1 那么该该方程无解.(不互质可以提出一个不为1公因子,除过去左边全是整数而右边却是真分数显然不可能)
补充2：什么是连分数
连分数（continued fraction）是特殊繁分数。
如果a0，a1，a2，…an，…都是整数，则将分别称为无限连分数和有限连分数。
可简记为a0 ，a1，a2，…，an，…和a0，a1，a2，…，an。一般一个有限连分数表示一个有理数，一个无限连分数表示一个无理数。
如果a0，a1，a2，…，an，…都是实数，可将上述形式连分数分别叫无限连分数和有限连分数 。
近代数学的计算需要，还可将连分数中的a0，a1 ，a2，…，an，…取成以x为变元的多项式。
在近代计算数学中它常与某些微分方程式差分方程有关，与某些递推关系有关的函数构造的应用相联系。
举例如：127/52 = 2 + 1/2+ 1/3+ 1/1+ 1/5
那连分数项目就是[2,2,3,1,5]
现在我们回过头来看回题目，题目先是把 flag 分成两部分（其实两部分加密方式是一样的），然后生成两个非常接近的大素数P1，P2，然后生成了两个相邻的较小的大素数Q1、Q2，用P1的平方和Q1相乘得到N1，N2则是用P2的平方和Q2相乘，再用两个相近巨大的加密指数E加密。
但是和普通的wiener attack 不同的是，e与N并没有相近到相除约为1的地步，相差还是很大的，也就是说解密指数 d 也许还是很大的。
有意思的是 e 和 N 的关系不符合利用条件，但是N1和N2的关系却适合，由于（P1/P2）**2 接近于1，所以 N1/N2 的比例很相近于Q1/Q2。
仿照 e/n 来展开：
通过：N1/N2=(P1/P2)**2 * (Q1/Q2)显然我们可以知道的是N1/N2 <Q1/Q2
所以在Q1/Q2在区间(N1/N2,1)之间 (这是关键，不用P1/P2是因为平方不好求）
尝试对N1/N2进行连分数展开并求其各项渐进分数，其中某个连分数的分子可能就是Q1（这个可以依靠N1%Q1==0来验证）
运行脚本exp.py得到：b'GWHT{3aadab41754799f978669d53e64a3aca}'
即：flag{3aadab41754799f978669d53e64a3aca}