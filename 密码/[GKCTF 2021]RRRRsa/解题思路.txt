代码中的式子如下：
{ h i n t 1 = ( 2020 ∗ p 1 + q 1 ) 202020 ( m o d   n 1 ) h i n t 2 = ( 2021 ∗ p 1 + 212121 ) q 1 ( m o d   n 1 ) h i n t 3 = ( 2020 ∗ p 2 + 2021 ∗ q 2 ) 202020 ( m o d   n 2 ) h i n t 4 = ( 2021 ∗ p 2 + 2020 ∗ q 2 ) 212121 ( m o d   n 2 )
⎧⎩⎨⎪⎪⎪⎪⎪⎪hint1=(2020∗p1+q1)202020(mod n1)hint2=(2021∗p1+212121)q1(mod n1)hint3=(2020∗p2+2021∗q2)202020(mod n2)hint4=(2021∗p2+2020∗q2)212121(mod n2)
{hint1=(2020∗p1+q1)202020(mod n1)hint2=(2021∗p1+212121)q1(mod n1)hint3=(2020∗p2+2021∗q2)202020(mod n2)hint4=(2021∗p2+2020∗q2)212121(mod n2)
⎩
⎪
⎪
⎪
⎨
⎪
⎪
⎪
⎧
hint1=(2020∗p1+q1) 
202020
 (mod n1)
hint2=(2021∗p1+212121) 
q1
 (mod n1)
hint3=(2020∗p2+2021∗q2) 
202020
 (mod n2)
hint4=(2021∗p2+2020∗q2) 
212121
 (mod n2)
利用二项式定理展开hint1,hint3,hint4，可将含p*q的项消除。
而hint2的化简可利用费马定理:
p 为 素 数 ， 则 对 任 意 a 有 a p = a   ( m o d   p ) p为素数，则对任意a有\\ a^p = a\ (mod\ p)
p为素数，则对任意a有
a 
p
 =a (mod p)
从而得到
{ h i n t 1 = ( 2020 ∗ p 1 ) 202020 + q 1 202020 ( m o d   n 1 ) h i n t 2 = 2021 ∗ p 1 + 212121 ( m o d   q 1 )
{hint1=(2020∗p1)202020+q1202020(mod n1)hint2=2021∗p1+212121(mod q1)
{hint1=(2020∗p1)202020+q1202020(mod n1)hint2=2021∗p1+212121(mod q1)
{ 
hint1=(2020∗p1) 
202020
 +q1 
202020
 (mod n1)
hint2=2021∗p1+212121(mod q1)
​{ h i n t 3 = ( 2020 ∗ p 2 ) 202020 + ( 2021 ∗ q 2 ) 202020 ( m o d   n 2 ) h i n t 4 = ( 2021 ∗ p 2 ) 212121 + ( 2020 ∗ q 2 ) 212121 ( m o d   n 2 )
{hint3=(2020∗p2)202020+(2021∗q2)202020(mod n2)hint4=(2021∗p2)212121+(2020∗q2)212121(mod n2)
{hint3=(2020∗p2)202020+(2021∗q2)202020(mod n2)hint4=(2021∗p2)212121+(2020∗q2)212121(mod n2)
{ 
hint3=(2020∗p2) 
202020
 +(2021∗q2) 
202020
 (mod n2)
hint4=(2021∗p2) 
212121
 +(2020∗q2) 
212121
 (mod n2)
​对于第一组进行消元，
{ h i n t 1 = ( 2020 ∗ p 1 ) 202020 + k 1 ∗ q 1 h i n t 2 − 212121 = 2021 ∗ p 1 + k 2 ∗ q 1
{hint1=(2020∗p1)202020+k1∗q1hint2−212121=2021∗p1+k2∗q1
{hint1=(2020∗p1)202020+k1∗q1hint2−212121=2021∗p1+k2∗q1
{ 
hint1=(2020∗p1) 
202020
 +k1∗q1
hint2−212121=2021∗p1+k2∗q1
​= = > { h i n t 1 = ( 2020 ∗ p 1 ) 202020 + k 1 ∗ q 1 ( m o d   n 1 ) ( h i n t 2 − 212121 ) 202020 = ( 2021 ∗ p 1 ) 202020 + ( k 2 ∗ q 1 ) 202020 ( m o d   n 1 ) ==>
{hint1=(2020∗p1)202020+k1∗q1(mod n1)(hint2−212121)202020=(2021∗p1)202020+(k2∗q1)202020(mod n1)
{hint1=(2020∗p1)202020+k1∗q1(mod n1)(hint2−212121)202020=(2021∗p1)202020+(k2∗q1)202020(mod n1)
==>{ 
hint1=(2020∗p1) 
202020
 +k1∗q1(mod n1)
(hint2−212121) 
202020
 =(2021∗p1) 
202020
 +(k2∗q1) 
202020
 (mod n1)
​= = > { ① 202 1 202020 ∗ h i n t 1 = ( 2020 ∗ 2021 ∗ p 1 ) 202020 + t 1 ∗ q 1 ( m o d   n 1 ) , t 1 = 202 1 202020 ∗ k 1 ② 202 1 202020 ∗ ( h i n t 2 − 212121 ) 202020 = ( 2020 ∗ 2021 ∗ p 1 ) 202020 + t 2 ∗ q 1 ( m o d   n 1 ) , t 2 = ( 2020 ∗ k ) 202020 ∗ q 1 202019 ==>
{①2021202020∗hint1=(2020∗2021∗p1)202020+t1∗q1(mod n1),t1=2021202020∗k1②2021202020∗(hint2−212121)202020=(2020∗2021∗p1)202020+t2∗q1(mod n1),t2=(2020∗k)202020∗q1202019
{①2021202020∗hint1=(2020∗2021∗p1)202020+t1∗q1(mod n1),t1=2021202020∗k1②2021202020∗(hint2−212121)202020=(2020∗2021∗p1)202020+t2∗q1(mod n1),t2=(2020∗k)202020∗q1202019
==>{ 
①2021 
202020
 ∗hint1=(2020∗2021∗p1) 
202020
 +t1∗q1(mod n1),t1=2021 
202020
 ∗k1
②2021 
202020
 ∗(hint2−212121) 
202020
 =(2020∗2021∗p1) 
202020
 +t2∗q1(mod n1),t2=(2020∗k) 
202020
 ∗q1 
202019
② − ① = k ∗ q 1 ( m o d   n 1 ) 即 ② − ① = k ∗ q 1 + t ∗ n 1 = k 3 ∗ q 1 , ( k = t 2 − t 3 , t , k 3 ∈ Z ) 所 以 q 1 = g c d ( ② − ① , n 1 ) \quad②-① = k*q1 \quad(mod\ n1) \\ 即②-① = k*q1+t*n1 = k3*q1,\quad (k=t2-t3,t,k3∈Z)\\ 所以q1 = gcd(②-①,n1)
②−①=k∗q1(mod n1)
即②−①=k∗q1+t∗n1=k3∗q1,(k=t2−t3,t,k3∈Z)
所以q1=gcd(②−①,n1)
求出q1，从而解出p。
同理hint3，hint4，得到
{ 202 1 202020 ∗ h i n t 3 = ( 2021 ∗ 2020 ∗ p 2 ) 202020 + ( 202 1 2 ∗ q 2 ) 202020 ( m o d   n 2 ) 202 0 212121 ∗ h i n t 4 = ( 2021 ∗ 2020 ∗ p 2 ) 212121 + ( 202 0 2 ∗ q 2 ) 212121 ( m o d   n 2 )
{2021202020∗hint3=(2021∗2020∗p2)202020+(20212∗q2)202020(mod n2)2020212121∗hint4=(2021∗2020∗p2)212121+(20202∗q2)212121(mod n2)
{2021202020∗hint3=(2021∗2020∗p2)202020+(20212∗q2)202020(mod n2)2020212121∗hint4=(2021∗2020∗p2)212121+(20202∗q2)212121(mod n2)
{ 
2021 
202020
 ∗hint3=(2021∗2020∗p2) 
202020
 +(2021 
2
 ∗q2) 
202020
 (mod n2)
2020 
212121
 ∗hint4=(2021∗2020∗p2) 
212121
 +(2020 
2
 ∗q2) 
212121
 (mod n2)
{ ① ( 202 1 202020 ∗ h i n t 3 ) 212121 = ( 2021 ∗ 2020 ∗ p 2 ) 202020 ∗ 212121 + ( 202 1 2 ∗ q 2 ) 202020 ∗ 212121 ( m o d   n 2 ) ② ( 202 0 212121 ∗ h i n t 4 ) 202020 = ( 2021 ∗ 2020 ∗ p 2 ) 202020 ∗ 212121 + ( 202 0 2 ∗ q 2 ) 2020202 ∗ 212121 ( m o d   n 2 )
{①(2021202020∗hint3)212121=(2021∗2020∗p2)202020∗212121+(20212∗q2)202020∗212121(mod n2)②(2020212121∗hint4)202020=(2021∗2020∗p2)202020∗212121+(20202∗q2)2020202∗212121(mod n2)
{①(2021202020∗hint3)212121=(2021∗2020∗p2)202020∗212121+(20212∗q2)202020∗212121(mod n2)②(2020212121∗hint4)202020=(2021∗2020∗p2)202020∗212121+(20202∗q2)2020202∗212121(mod n2)
{ 
①(2021 
202020
 ∗hint3) 
212121
 =(2021∗2020∗p2) 
202020∗212121
 +(2021 
2
 ∗q2) 
202020∗212121
 (mod n2)
②(2020 
212121
 ∗hint4) 
202020
 =(2021∗2020∗p2) 
202020∗212121
 +(2020 
2
 ∗q2) 
2020202∗212121
 (mod n2)
② − ① = k 1 ∗ q 2 ( m o d   n 2 ) 即 ② − ① = k 1 ∗ q 2 + k 2 ∗ n 2 = k ∗ q 2 从 而 q 2 = g c d ( ② − ① , n 2 ) \quad②-① = k1*q2\quad(mod\ n2)\\ 即②-① = k1*q2+k2*n2=k*q2\\ 从而q2=gcd(②-①,n2)
②−①=k1∗q2(mod n2)
即②−①=k1∗q2+k2∗n2=k∗q2
从而q2=gcd(②−①,n2)
运行脚本exp.py得到其中：GKCTF{f64310b5-d5e6-45cb-ae69-c86600cdf8d8}
即：flag{f64310b5-d5e6-45cb-ae69-c86600cdf8d8}